
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript" src="/lib/jquery.event.drag-2.0.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
    App = {}
    App.socket = io.connect()
    App.socket.on('draw', function(data) {
        App.draw(data.x, data.y, data.type)
    })
    // Init function.
    App.init = function() {
        App.ctx = $('canvas')[0].getContext("2d")
        App.ctx.fillStyle = "solid"        
        App.ctx.strokeStyle = "#bada55"    
        App.ctx.lineWidth = 5               
        App.ctx.lineCap = "round"
        $('canvas').live('drag dragstart dragend', function(e) {
            type = e.handleObj.type
            offset = $(this).offset()
            var x = e.clientX - offset.left
            var y = e.clientY - offset.top
            App.draw(x,y,type)
            App.socket.emit('drawClick', { x : x, y : y, type : type})
        })
    }         
    // Draw Function
    App.draw = function(x,y,type) {
        if (type == "dragstart") {
            App.ctx.beginPath()
            App.ctx.moveTo(x,y)
        } else if (type == "drag") {
            App.ctx.lineTo(x,y)
            App.ctx.stroke()
        } else {
            App.ctx.stroke()
            App.ctx.closePath()
        }
    }
    $(function() {
        App.init()
    })
</script>
<canvas width="800px", height="400px"></canvas>
